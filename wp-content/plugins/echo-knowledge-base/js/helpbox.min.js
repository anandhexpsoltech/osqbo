jQuery(document).ready(function(e){function _(_=!1){_?e("#epkb-help_box__contact-box-container").addClass("epkb-help_box__loading"):e(".epkb-help_box__search_results_container").addClass("epkb-help_box__loading"),e(".eckb-help_box__loading-spinner").show()}function a(_=!1){_?e("#epkb-help_box__contact-box-container").removeClass("epkb-help_box__loading"):e(".epkb-help_box__search_results_container").removeClass("epkb-help_box__loading"),e(".eckb-help_box__loading-spinner").hide()}function t(){e(".eckb-help_box__header-back-icon").show(),e(".eckb-help_box__header-logo").hide()}function o(){e(".eckb-help_box__header-back-icon").hide(),e(".eckb-help_box__header-logo").show()}e(".eckb-help-box-toggle__right_away").length&&jQuery(".eckb-help-box-toggle__right_away").show(),e(".eckb-help-box-toggle__after_delay").length&&setTimeout(function(){jQuery(".eckb-help-box-toggle__after_delay").show()},1e3),e("body").on("click",".epkb-help_box_cat-item",function(_){if(_.preventDefault(),""===e(this).data("category"))return;let a=e(this).data("category");e(".epkb-help_box__search-box").hide(),e(".epkb-help_box__search_step").removeClass("epkb-help_box__search_step_active"),e("#epkb-help_box__cat-article").addClass("epkb-help_box__search_step_active"),e("#epkb-help_box__cat-article .epkb-help_box_article-box").hide(),e("#epkb-help_box__cat-article .epkb-help_box_article-box[data-category="+a+"]").show(),t()}),e("body").on("click",".epkb-help_box_article-item",function(o){if(o.preventDefault(),""!==e(this).data("kb-article-id")){var s={action:"epkb_help_box_article_detail",article_id:e(this).data("kb-article-id"),type:e(this).data("type")},b="";e.ajax({type:"POST",dataType:"json",data:s,url:ajaxurl,beforeSend:function(e){_()}}).done(function(e){e=e||"",a(),b=e.error||"success"!==e.status?epkb_vars.msg_try_again:e.search_result}).fail(function(e,_,a){b=epkb_vars.msg_try_again+". ["+(a||epkb_vars.unknown_error)+"]"}).always(function(){a(),b&&(e(".epkb-help_box__search-box").hide(),e(".epkb-help_box__search_step").removeClass("epkb-help_box__search_step_active"),e("#epkb-help_box__search_results-cat-article-details").addClass("epkb-help_box__search_step_active"),e("#epkb-help_box__search_results-cat-article-details").html(b),t())})}}),e("body").on("input","#epkb-help_box__search-terms",function(){e(this).val().length>=3&&function(t,s){let b=t,c=b.val();b.data("kb-id"),setTimeout(function(){if(c===b.val()){var t={action:"epkb_help_box_search_kb",search_terms:c};e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:t,beforeSend:function(e){_()}}).done(function(e){e=e||"",a(),e.error||"success"!==e.status?msg=epkb_vars.msg_try_again:msg=e.search_result}).fail(function(e,_,a){msg=epkb_vars.msg_try_again+". ["+(a||epkb_vars.unknown_error)+"]"}).always(function(){a(),msg&&(e(".epkb-help_box__search_step").removeClass("epkb-help_box__search_step_active"),e("#epkb-help_box__search_results").addClass("epkb-help_box__search_step_active"),e("#epkb-help_box__search_results").html(msg),o())})}},s)}(e(this),500)}),e("#epkb-help_box__search-terms").keyup(function(_){(!e(this).val()||e(this).val().length<3)&&(e(".epkb-help_box__search_step").removeClass("epkb-help_box__search_step_active"),e("#epkb-help_box__cat").addClass("epkb-help_box__search_step_active"))}),e(".eckb-help-box-toggle").on("click",function(){var t=e(this).find("i");t.hasClass("epkbfa-comments-o")?(!e(".epkb-help_box_categories").length&&e(".eckb-help_box__search").length&&function(){var t="",o="",s="";e.ajax({type:"POST",dataType:"json",data:{action:"epkb_help_box_get_category_list"},url:ajaxurl,beforeSend:function(e){_()}}).done(function(e){e=e||"",a(),e.error||"success"!==e.status?t=epkb_vars.msg_try_again:(o=e.category_list,s=e.article_list)}).fail(function(e,_,a){t=epkb_vars.msg_try_again+". ["+(a||epkb_vars.unknown_error)+"]"}).always(function(){a(),t?e("#epkb-help_box__cat").html(t):(e("#epkb-help_box__cat").html(o),e("#epkb-help_box__cat-article").html(s))})}(),t.removeClass("epkbfa-comments-o"),t.addClass("epkbfa-close"),e(".eckb-help_box__search").length?(e(".eckb-help_box__search").show(),e(".eckb-help_box__contact").hide(),e(".eckb-help_box__header-button-contact").show(),e(".eckb-help_box__header-button-search").hide(),e(".eckb-help_box__header_faq__title").show(),e(".eckb-help_box__header_contact__title").hide()):(e(".eckb-help_box__contact").show(),e(".eckb-help_box__header-button-contact").hide(),e(".eckb-help_box__header_faq__title").hide(),e(".eckb-help_box__header_contact__title").show()),e(".epkb-help_box__search-box").show(),e(".epkb-help_box__search_step").removeClass("epkb-help_box__search_step_active"),e("#epkb-help_box__cat").addClass("epkb-help_box__search_step_active"),e("#eckb-help-box").show(),o()):(t.removeClass("epkbfa-close"),t.addClass("epkbfa-comments-o"),e("#eckb-help-box").hide())}),e(".eckb-help_box__header-button-contact").on("click",function(){e(this).hide(),e(".eckb-help_box__search").hide(),e(".eckb-help_box__contact").show(),e(".eckb-help_box__header-button-search").show(),e(".eckb-help_box__header_faq__title").hide(),e(".eckb-help_box__header_contact__title").show(),o()}),e(".eckb-help_box__header-button-search").on("click",function(){e(this).hide(),e(".eckb-help_box__search").show(),e(".eckb-help_box__contact").hide(),e(".epkb-help_box__search-box").show(),e(".epkb-help_box__search_step").removeClass("epkb-help_box__search_step_active"),e("#epkb-help_box__cat").addClass("epkb-help_box__search_step_active"),e(".eckb-help_box__header-button-contact").show(),e(".eckb-help_box__header_faq__title").show(),e(".eckb-help_box__header_contact__title").hide(),o()}),e(".eckb-help_box__header-back-icon").on("click",function(){let _=e(".epkb-help_box__search_step_active").data("step"),a=_-1==0?2:_-1;4==_&&e(".epkb-help_box_type_search").length&&(a=1),1!=a&&2!=a||(o(),e(".epkb-help_box__search-box").show()),e(".epkb-help_box__search_step").removeClass("epkb-help_box__search_step_active"),e(".epkb-help_box__search_step[data-step="+a+"]").addClass("epkb-help_box__search_step_active")}),e(document).on("submit","#epkb-help_box__contact-form",function(t){if(t.preventDefault(),!jQuery("#eckb-help-box").is(":visible"))return;if(!jQuery(".eckb-help_box__contact").is(":visible"))return;let o=e(this);e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:o.serialize(),beforeSend:function(e){_(!0)}}).done(function(_){void 0!==_.success&&0==_.success?e(".epkb-help_box__contact-form-response").html(_.data):void 0!==_.success&&1==_.success?e(".epkb-help_box__contact-form-response").html(_.data):e(".epkb-help_box__contact-form-response").html(epkb_vars.msg_try_again)}).fail(function(_,a,t){e(".epkb-help_box__contact-form-response").html(epkb_vars.msg_try_again)}).always(function(){a(!0)})})});