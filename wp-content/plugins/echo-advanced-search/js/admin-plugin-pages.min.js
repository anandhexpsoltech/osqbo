jQuery(document).ready(function(e){function a(a){e("#asea_datatable").html(a)}function n(){e("#asea_license_check").html("");s("GET",{action:"asea_handle_license_request",command:"get_license_info"},"Retrieving license status. Please wait.",t)}function t(a){e("#asea_license_check").html(a)}function s(a,n,t,s){var i;e(".eckb-top-notice-message").html(""),e.ajax({type:a,dataType:"json",data:n,url:ajaxurl,beforeSend:function(e){o("show",t)}}).done(function(e){if((e=e||"").message||void 0===e.output)i=e.message?e.message:c("","Advanced Search: Error occurred. Please try again later. (L01)","error");else{var a=void 0!==e.output&&e.output?e.output:c("","Please reload the page and try again (L37).","error");s(a)}}).fail(function(e,a,n){i=c("Advanced Search: Error occurred. Please try again later. (L02)",i=n?" ["+n+"]":"unknown error","error")}).always(function(){o("remove",""),i&&(e(".eckb-top-notice-message").replaceWith(i),e("html, body").animate({scrollTop:0},"slow"))})}function o(a,n){if("show"===a){var t='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(n?'<div class="epkb-admin-text">'+n+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(t)}else"remove"===a&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}function c(e,a,n){return'<div class="eckb-top-notice-message"><div class="contents"><span class="'+n+'">'+(e?"<h4>"+e+"</h4>":"")+(a||"")+"</span></div></div>"}if(e("#asea-ajax-in-progress").dialog({resizable:!1,height:70,width:200,modal:!1,autoOpen:!1}).hide(),e("#asea_datatable").length){e("#asea_datatable").DataTable();var i=moment().subtract(7,"days"),r=moment();e("#reportrange").daterangepicker({startDate:i,endDate:r,maxDate:r,maxSpan:{months:12},autoUpdateInput:!1,ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]}},function(e,a,n){d(e,a,n)});function d(n,t,o){e("#reportrange span").html(" &nbsp;&nbsp;<strong>"+o+"</strong>: &nbsp;&nbsp;"+n.format("MMM D, YYYY")+" - "+t.format("MMM D, YYYY")+"&nbsp;&nbsp;&nbsp;");s("POST",{action:"asea_handle_search_analytics",kb_id:e("#eckb_kb_id").val(),start_date:n.format("YYYY-MM-DD"),end_date:t.format("YYYY-MM-DD"),_wpnonce_asea_search_analytics:e("#_wpnonce_asea_search_analytics").val()},"Getting data...",a)}d(i,r,"Last 7 days")}var l=e("#ekcb-licenses");e("#eckb_license_tab").hasClass("active")&&n(),e("#wpbody").on("click","#eckb_license_tab",function(e){n()}),l.on("click","#asea_save_btn",function(a){a.preventDefault();s("POST",{action:"asea_handle_license_request",asea_license_key:e("#asea_license_key").val().trim(),_wpnonce_asea_license_key:e("#_wpnonce_asea_license_key").val(),command:"save"},"Saving license...",t)}),e("#wpbody-content").on("click",".asea-search-toggle",function(){e(this).closest(".epkb-wc-step-panel").find(".asea-advanced-search-container, .elay-advanced-search-container").slideToggle()})});